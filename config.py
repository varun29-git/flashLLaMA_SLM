# # ============================================================
# # MODEL SIZE 
# # ============================================================

# D_MODEL = 1024          
# N_LAYERS = 24           
# N_Q_HEADS = 16          
# N_KV_HEADS = 4          
# D_FF = 4096             
# DROPOUT = 0.0           

# # ============================================================
# # SEQUENCE / BATCH 
# # ============================================================

# SEQ_LEN = 1024         
# BATCH_SIZE = 64        

# # ============================================================
# # TRAINING SCHEDULE 
# # ============================================================

# EPOCHS = 3              
# STEPS_PER_EPOCH = 50_000

# # ============================================================
# # OPTIMIZATION
# # ============================================================

# LR = 3e-4               
# WEIGHT_DECAY = 0.1      

# # ============================================================
# # SYSTEM / INFRA
# # ============================================================

# MODEL_FOLDER = "checkpoints"
# PRELOAD = None         
# VAL_SPLIT = 0.0         

# ============================================================
# MODEL SIZE 
# ============================================================

D_MODEL = 512
N_LAYERS = 12
N_Q_HEADS = 8
N_KV_HEADS = 2
D_FF = 2048
DROPOUT = 0.1

# ============================================================
# SEQUENCE / BATCH 
# ============================================================

SEQ_LEN = 512
BATCH_SIZE = 8       # micro-batch
GRAD_ACCUM_STEPS = 16   # effective batch = 64

# ============================================================
# TRAINING SCHEDULE 
# ============================================================

EPOCHS = 1
STEPS_PER_EPOCH = 2

# ============================================================
# OPTIMIZATION
# ============================================================

LR = 4e-4
WEIGHT_DECAY = 0.1

# ============================================================
# SYSTEM / INFRA
# ============================================================

MODEL_FOLDER = "checkpoints"
PRELOAD = None
VAL_SPLIT = 0.05
